
Load the modules that are needed for training:

module load GCC

module load CUDA

module load PyTorch

module load torchvision


jutil env activate -p training2557

curl -LsSf https://astral.sh/uv/install.sh | sh

cat << EOF >> ~/.bashrc
export UV_PYTHON_INSTALL_DIR=$PROJECT/user_dirs/$USER/uv/python
export UV_CACHE_DIR=$PROJECT/user_dirs/$USER/uv/cache
export UV_TOOL_DIR=$PROJECT/user_dirs/$USER/uv/tools
EOF



Python Virtual Environments
(I use uv to manage this, but there are other ways)

1. Activate the project
2. Install uv (conda alternative)
3. Configure uv (one command; make sure to not add an extra line at the end)
4. Restart shell

exec bash

mkdir project && cd project

a. Either: Add them to a pyproject.toml
uv init -p 3.12 (where 3.12 is the python version, see uv python list
for available version)
uv add torch torchvision
i. Create virtual environment
uv venv -p 3.12 (where 3.12 is the python version, see uv python
list for available version)
ii. Activate it
source .venv/bin/activate
iii. uv pip install torch torchvision install your packages
b. Or: Use the venv/pip interface
6. Install packages
7. Run the python with all your packages
srun .venv/bin/python script.py asdasd
(project) [wahdany1@jrlogin05 project]$ srun --pty .venv/bin/python
Python 3.12.12 (main, Oct 28 2025, 12:10:49) [Clang 20.1.4 ] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> import numpy
numpy
>>> numpy
<module 'numpy' from
'/p/home/jusers/wahdany1/jureca/project/.venv/lib/python3.12/site-packag
es/numpy/__init__.py'>

(`module load` etc.). (See final paragraph in README for usage instructions.)
1. Create a venv using:
[`sc_venv_template`](https://gitlab.jsc.fz-juelich.de/kesselheim1/sc_venv_templat
e) to create a Python virtual environment together with the module system
I.e clone it into your folder using: git clone
https://gitlab.jsc.fz-juelich.de/kesselheim1/sc_venv_template.git

(Optional) If you need additional requirements, add them into the requirements.txt file.

5. Go into the project
Now you should be able to import your packages on the compute node, similar to this:

Python Venv (Zoom Version, ask Michel)


Then run bash setup.sh to create the venv

2. Setup a bash scrip like this:
Multi-GPU multi-job single-GPU script:

```shell

#!/bin/bash

#SBATCH --account=training2557 # project2559 in your case

# SBATCH --reservation=syshack1

#SBATCH --nodes=1

#SBATCH --ntasks-per-node=1

#SBATCH --gres=gpu:4

#SBATCH --cpus-per-task=128 # JURECA has 128 physical CPU cores

#SBATCH --partition=dc-gpu-devel

#SBATCH --output=output/%j.out

# export MASTER_ADDR="$(scontrol show hostnames "$SLURM_JOB_NODELIST" | head -n 1)"

# export MASTER_ADDR="$MASTER_ADDR"i

source activate.sh

echo 'done!'

```

Adapt the source and python path according to your needs

3. Run the script using sbatch script.sh
2. Run chmod +x set_acls.sh
3. Run ./set_acls.sh user1,user2,... /path/to/folder
Where user1,user2,.. Are the judoor users that should have write-acess and
/path/to/folder is the folder you want to edit
1. Save this to a bash script like set_acls.sh
#!/bin/bash
# Script to set ACLs on a folder recursively
# Usage: ./set_acls.sh <comma-separated-users> <folder-path>
set -euo pipefail

env CUDA_VISIBLE_DEVICES="0" srun --overlap python task_template.py &

wait

Setting Common-Folder Permissions

# Check if correct number of arguments provided
if [ $# -ne 2 ]; then
echo "Usage: $0 <comma-separated-users> <folder-path>"
echo "Example: $0 alice,bob,charlie /path/to/folder"
exit 1
fi
USERS="$1"
FOLDER="$2"
# Check if folder exists
if [ ! -d "$FOLDER" ]; then
echo "Error: Folder '$FOLDER' does not exist"
exit 1
fi
# Check if setfacl is available
if ! command -v setfacl &> /dev/null; then
echo "Error: setfacl command not found. Please install acl package"
exit 1
fi
echo "Setting ACLs on folder: $FOLDER"
echo "Users with edit access: $USERS"
echo ""
# Convert comma-separated list to array
IFS=',' read -ra USER_ARRAY <<< "$USERS"
# Validate that users exist
for user in "${USER_ARRAY[@]}"; do
if ! id "$user" &> /dev/null; then
echo "Warning: User '$user' does not exist on this system"
fi
done
echo "Removing existing ACLs..."
setfacl -R -b "$FOLDER"
echo "Setting base permissions..."
# Set base permissions: owner rwx, group r-x, others r-x
chmod -R u=rwX,g=rX,o=rX "$FOLDER"
echo "Setting ACLs for specified users..."
# Set ACLs for each user to have read, write, and execute permissions
for user in "${USER_ARRAY[@]}"; do



echo " - Granting rwX to $user"
# Current files/directories
setfacl -R -m "u:${user}:rwX" "$FOLDER"
# Default ACLs for new files/directories
setfacl -R -m "d:u:${user}:rwX" "$FOLDER"
done
# Set default permissions for new files
# Owner gets rwx, group gets r-x, others get r-x
echo "Setting default ACLs for new files..."
setfacl -R -m "d:u::rwX" "$FOLDER"
setfacl -R -m "d:g::rX" "$FOLDER"
setfacl -R -m "d:o::rX" "$FOLDER"